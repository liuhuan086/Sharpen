# 介绍

服务器端对客户提出的数据操作请求过分信任，忽略了对该**用户操作权限的判定**，导致攻击账号拥有了其他账户的增删改查功能。

# 分类

* 水平越权
* 垂直越权

# 越权操作

* 越权查询
* 越权删除
* 越权修改
* 越权增加

# 水平越权

相同级别（权限）的用户或同一角色不同的用户之间，可以越权访问、修改或删除的非法操作，被成为水平越权。

## 如何测试

靶场地址：http://www.rbac.com/www/index.php/order-browse.html

| 账号     | 密码    |
| -------- | ------- |
| moonteam | x123456 |
| moon     | x123456 |

### 效果一

用户moon登录并添加商品，其他用户没有登录，但是能通过页面猜解和穷举，在不登陆的情况下看到用户moon所购买的商品信息。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210825225522.png)

### 效果二

moonteam用户在登录的情况下，通过猜解到其他用户的页面地址进而访问到用户moon所访问的订单页面。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210825225721.png)

# 垂直越权

垂直越权是不同级别（权限）或不同角色之间的用户之间的越权。由于后台应用没有做权限控制，或仅仅在菜单、按钮上做了权限控制，导致恶意用户只要猜测其他管理页面的URL或者敏感的参数信息，就可以访问或控制其他角色拥有的数据或页面，达到权限提升的目的。

## 如何测试

一般垂直越权是用普通账号去测试较高权限用户的操作，比如增删改查。

### 效果

当我用管理员账号删除帖子，URL的请求参数通过抓包可以得到如下。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210825235138.png)

```
GET /www/admin.php?m=thread&f=delete&threadID=1 HTTP/1.1
```

然后我以moonteam用户的身份发表一个帖子，从管理员页面看到id为10，那么我以moonteam的身份去修改请求的时候，尝试将这篇帖子删除。

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210826081135.png)

![](https://borinboy.oss-cn-shanghai.aliyuncs.com/huan20210826081015.png)

可以看到这里已经没有id为10的帖子了。

至于在实际测试中如何猜解到高权限用户的请求方式，参数，则需要不断去尝试，比如，在有些场景下的请求参数中，用role=0和role=1来区分普通用户和管理员，那么我们就可以以普通用户身份登录，通过抓包并修改role的参数，来达到越权访问的目的。

